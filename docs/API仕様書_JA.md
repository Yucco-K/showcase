# Portfolio Showcase - API ä»•æ§˜æ›¸

---

## ğŸ†• 2025 å¹´ 7 æœˆ 27 æ—¥ ä¸»ãªæ©Ÿèƒ½è¿½åŠ ãƒ»æ”¹å–„

- **ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ API ã®ãƒªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: Deno ãƒ™ãƒ¼ã‚¹ã® Supabase Edge Function ã‹ã‚‰ Python + FastAPI + LangChain ãƒ™ãƒ¼ã‚¹ã® Vercel Serverless Function ã«ç§»è¡Œã—ã€å¿œç­”æ€§èƒ½ã¨æ‹¡å¼µæ€§ã‚’å‘ä¸Šã€‚
- **RAG ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å¼·åŒ–**: LangChain ã‚’å°å…¥ã—ã€ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã¨çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã®æ‹¡å¼µæ€§ã‚’å¼·åŒ–ã€‚
- **API åŸºç›¤ã®æ”¹å–„**: FastAPI ãƒ«ãƒ¼ã‚¿ãƒ¼ã€CORS å¯¾å¿œã€ç’°å¢ƒå¤‰æ•°ç®¡ç†ã®å®‰å®šåŒ–ã€‚

## ğŸ†• 2025 å¹´ 7 æœˆ 25 æ—¥ã€œ26 æ—¥ ä¸»ãªæ©Ÿèƒ½è¿½åŠ ãƒ»æ”¹å–„

- **FAQ ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ API**: OpenAI API çµ±åˆã€Supabase Edge Functions ã«ã‚ˆã‚‹ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å®Ÿè£…
- **ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†**: user_idã€session_id ä»˜ããƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿å­˜ã€åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œ
- **FAQ ãƒ‡ãƒ¼ã‚¿ç®¡ç†**: 15 å€‹ã® FAQ è³ªå•ã€äººæ°—åº¦ã«ã‚ˆã‚‹è‡ªå‹•ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
- **Information ãƒšãƒ¼ã‚¸ API**: UI æœ€é©åŒ–ã€ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š
- **ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ API**: Gorse API é€£æºã€é›†è¨ˆãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£
- **ä¾å­˜é–¢ä¿‚ç®¡ç†**: Zod ç«¶åˆè§£æ±ºã€OpenAI SDK äº’æ›æ€§ç¢ºä¿

## ğŸ†• 2025 å¹´ 7 æœˆ 21 æ—¥ãƒ»22 æ—¥ ä¸»ãªæ©Ÿèƒ½è¿½åŠ ãƒ»æ”¹å–„

- ãŠå•ã„åˆã‚ã› API ã«ã‚«ãƒ†ã‚´ãƒªï¼ˆcategoryï¼‰ã€ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆtitleï¼‰ã€ãƒ”ãƒ³ç•™ã‚ï¼ˆis_pinnedï¼‰æ©Ÿèƒ½ã‚’è¿½åŠ 
- ãŠå•ã„åˆã‚ã›è¿”ä¿¡ã®ã‚¹ãƒ¬ãƒƒãƒ‰åŒ–ï¼ˆcontact_reply_threads ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- ãƒ¬ãƒ“ãƒ¥ãƒ¼ API ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆï¼ˆæ˜Ÿæ•°ãƒ»æ—¥ä»˜é †ãƒ»ç®¡ç†è€…ãƒ¬ãƒ“ãƒ¥ãƒ¼ç‰¹åˆ¥æ‰±ã„ï¼‰æ©Ÿèƒ½ã‚’è¿½åŠ 
- ãƒ¬ãƒ“ãƒ¥ãƒ¼ã® 3 éšå±¤ãƒã‚¹ãƒˆè¿”ä¿¡æ©Ÿèƒ½
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ï¼ˆãƒ¡ãƒ¼ãƒ«èªè¨¼å¿…é ˆã€ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œåˆ¶é™ã€Zod ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- å‹å®šç¾©ãƒ»ãƒ•ãƒƒã‚¯å…±é€šåŒ–ã€UI/UXãƒ»ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ”¹å–„

---

## ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 2.0

**æ–‡æ›¸ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** 2.0
**æœ€çµ‚æ›´æ–°:** 2025 å¹´ 7 æœˆ
**ãƒ™ãƒ¼ã‚¹ URL:** `https://showcase-topaz.vercel.app`
**API ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** v1
**å®Ÿè£…çŠ¶æ³:** âœ… å®Ÿè£…æ¸ˆã¿

---

## æ¦‚è¦

ã“ã®æ–‡æ›¸ã¯ã€Portfolio Showcase Version 2.0 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®åŒ…æ‹¬çš„ãª API ä»•æ§˜ã‚’æä¾›ã—ã¾ã™ã€‚API ã¯ Supabase ä¸Šã«æ§‹ç¯‰ã•ã‚Œã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®å…¨æ©Ÿèƒ½ã«å¯¾ã™ã‚‹ RESTful ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚

### å®Ÿè£…çŠ¶æ³ã®è¡¨è¨˜ã«ã¤ã„ã¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€æ©Ÿèƒ½ã®å®Ÿè£…çŠ¶æ³ã‚’ä»¥ä¸‹ã®è¨˜å·ã§è¡¨è¨˜ã—ã¾ã™ï¼š

- âœ… **å®Ÿè£…æ¸ˆã¿**: æœ¬ç•ªç’°å¢ƒã§åˆ©ç”¨å¯èƒ½ãªæ©Ÿèƒ½
- âš ï¸ **éƒ¨åˆ†çš„å®Ÿè£…**: åŸºæœ¬æ©Ÿèƒ½ã®ã¿å®Ÿè£…æ¸ˆã¿ã®æ©Ÿèƒ½
- ğŸ“‹ **æœªå®Ÿè£…**: ä»Šå¾Œã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã§å®Ÿè£…äºˆå®šã®æ©Ÿèƒ½

### èªè¨¼

ã™ã¹ã¦ã® API ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¯ã€Supabase Auth ã‚’é€šã˜ã¦å–å¾—ã—ãŸ JWT ãƒˆãƒ¼ã‚¯ãƒ³ã«ã‚ˆã‚‹èªè¨¼ãŒå¿…è¦ã§ã™ã€‚

```http
Authorization: Bearer <jwt_token>
```

### åŸºæœ¬ãƒ˜ãƒƒãƒ€ãƒ¼

```http
Content-Type: application/json
Accept: application/json
```

---

## èªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²

**POST** `/auth/v1/signup`

æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç™»éŒ²ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"email": "user@example.com",
	"password": "your_password_here"
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"user": {
		"id": "uuid",
		"email": "user@example.com",
		"created_at": "2025-01-15T10:30:00Z"
	},
	"session": {
		"access_token": "your_jwt_token_here",
		"refresh_token": "your_refresh_token_here",
		"expires_at": 1642234567
	}
}
```

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³

**POST** `/auth/v1/token?grant_type=password`

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’èªè¨¼ã—ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"email": "user@example.com",
	"password": "your_password_here"
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"access_token": "your_jwt_token_here",
	"refresh_token": "your_refresh_token_here",
	"expires_at": 1642234567,
	"user": {
		"id": "uuid",
		"email": "user@example.com"
	}
}
```

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ

**POST** `/auth/v1/logout`

ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç„¡åŠ¹åŒ–ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼

```http
Authorization: Bearer <your_jwt_token_here>
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"message": "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ"
}
```

---

## ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†

### ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—

**GET** `/rest/v1/profiles?select=*&id=eq.{user_id}`

ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
[
	{
		"id": "uuid",
		"email": "user@example.com",
		"full_name": "ç”°ä¸­å¤ªéƒ",
		"avatar_url": "https://example.com/avatar.jpg",
		"biography": "5å¹´ã®çµŒé¨“ã‚’æŒã¤ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…",
		"created_at": "2025-01-15T10:30:00Z",
		"updated_at": "2025-01-15T10:30:00Z"
	}
]
```

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°

**PATCH** `/rest/v1/profiles?id=eq.{user_id}`

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"full_name": "ç”°ä¸­å¤ªéƒ",
	"biography": "æ›´æ–°ã•ã‚ŒãŸè‡ªå·±ç´¹ä»‹"
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"id": "uuid",
	"full_name": "ç”°ä¸­å¤ªéƒ",
	"biography": "æ›´æ–°ã•ã‚ŒãŸè‡ªå·±ç´¹ä»‹",
	"updated_at": "2025-01-15T11:00:00Z"
}
```

---

## å•†å“ç®¡ç†

### ãƒ‡ã‚¸ã‚¿ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å…¨ä»¶å–å¾— âœ…

**GET** `/rest/v1/products?select=*&is_active=eq.true&order=created_at.desc`

ã™ã¹ã¦ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ã‚¸ã‚¿ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
[
	{
		"id": "uuid",
		"name": "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ",
		"description": "ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ",
		"price": 10000,
		"image_url": "https://example.com/template.jpg",
		"category": "templates",
		"is_active": true,
		"created_at": "2025-01-15T10:30:00Z",
		"updated_at": "2025-01-15T10:30:00Z"
	}
]
```

### å•†å“ ID ã«ã‚ˆã‚‹å–å¾—

**GET** `/rest/v1/products?select=*&id=eq.{product_id}`

ç‰¹å®šã®å•†å“è©³ç´°ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
[
	{
		"id": "uuid",
		"name": "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ",
		"description": "é«˜åº¦ãªæ©Ÿèƒ½ã‚’å‚™ãˆãŸãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ",
		"price": 10000,
		"image_url": "https://example.com/template.jpg",
		"category": "templates",
		"is_active": true,
		"extra_info": {
			"features": ["ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³", "SEOæœ€é©åŒ–"],
			"download_url": "https://example.com/download"
		},
		"created_at": "2025-01-15T10:30:00Z",
		"updated_at": "2025-01-15T10:30:00Z"
	}
]
```

### å•†å“ä½œæˆï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

**POST** `/rest/v1/products`

æ–°ã—ã„å•†å“ã‚’ä½œæˆã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"name": "æ–°å•†å“",
	"description": "å•†å“ã®èª¬æ˜",
	"price": 20000,
	"category": "software",
	"is_active": true
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"id": "uuid",
	"name": "æ–°å•†å“",
	"description": "å•†å“ã®èª¬æ˜",
	"price": 20000,
	"category": "software",
	"is_active": true,
	"created_at": "2025-01-15T10:30:00Z"
}
```

### å•†å“æ›´æ–°ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

**PATCH** `/rest/v1/products?id=eq.{product_id}`

å•†å“æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"name": "æ›´æ–°ã•ã‚ŒãŸå•†å“å",
	"price": 15000
}
```

### å•†å“å‰Šé™¤ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

**DELETE** `/rest/v1/products?id=eq.{product_id}`

å•†å“ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

---

## è³¼å…¥ç®¡ç†

### è³¼å…¥ä½œæˆ

**POST** `/rest/v1/product_purchases`

æ–°ã—ã„è³¼å…¥è¨˜éŒ²ã‚’ä½œæˆã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"user_id": "uuid",
	"product_id": "uuid",
	"stripe_payment_intent_id": "pi_1234567890",
	"amount": 1,
	"status": "completed"
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"id": "uuid",
	"user_id": "uuid",
	"product_id": "uuid",
	"stripe_payment_intent_id": "pi_1234567890",
	"amount": 1,
	"status": "completed",
	"created_at": "2025-01-15T10:30:00Z"
}
```

### ãƒ¦ãƒ¼ã‚¶ãƒ¼è³¼å…¥å±¥æ­´å–å¾—

**GET** `/rest/v1/product_purchases?select=*,products(*)&user_id=eq.{user_id}&order=created_at.desc`

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³¼å…¥å±¥æ­´ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
[
	{
		"id": "uuid",
		"user_id": "uuid",
		"product_id": "uuid",
		"amount": 1,
		"status": "completed",
		"created_at": "2025-01-15T10:30:00Z",
		"products": {
			"id": "uuid",
			"name": "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ",
			"description": "ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ"
		}
	}
]
```

---

## ãƒ–ãƒ­ã‚°ç®¡ç†

### å…¬é–‹æ¸ˆã¿ãƒ–ãƒ­ã‚°å…¨ä»¶å–å¾—

**GET** `/rest/v1/blogs?select=*,profiles(full_name)&is_published=eq.true&order=created_at.desc`

ã™ã¹ã¦ã®å…¬é–‹æ¸ˆã¿ãƒ–ãƒ­ã‚°æŠ•ç¨¿ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
[
	{
		"id": "uuid",
		"title": "Reactå…¥é–€",
		"content": "Reactã¯å¼·åŠ›ãªJavaScriptãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™...",
		"author_id": "uuid",
		"is_published": true,
		"created_at": "2025-01-15T10:30:00Z",
		"updated_at": "2025-01-15T10:30:00Z",
		"profiles": {
			"full_name": "ç”°ä¸­å¤ªéƒ"
		}
	}
]
```

### ãƒ–ãƒ­ã‚° ID ã«ã‚ˆã‚‹å–å¾—

**GET** `/rest/v1/blogs?select=*,profiles(full_name)&id=eq.{blog_id}`

ç‰¹å®šã®ãƒ–ãƒ­ã‚°æŠ•ç¨¿ã‚’å–å¾—ã—ã¾ã™ã€‚

### ãƒ–ãƒ­ã‚°ä½œæˆï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

**POST** `/rest/v1/blogs`

æ–°ã—ã„ãƒ–ãƒ­ã‚°æŠ•ç¨¿ã‚’ä½œæˆã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"title": "æ–°ã—ã„ãƒ–ãƒ­ã‚°æŠ•ç¨¿",
	"content": "ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å½¢å¼ã®ãƒ–ãƒ­ã‚°å†…å®¹",
	"author_id": "uuid",
	"is_published": true
}
```

---

## ãŠå•ã„åˆã‚ã›ç®¡ç†

### ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ âœ…

**POST** `/rest/v1/contacts`

æ–°ã—ã„ãŠå•ã„åˆã‚ã›ã‚’é€ä¿¡ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"name": "ç”°ä¸­å¤ªéƒ",
	"email": "tanaka@example.com",
	"title": "é€€ä¼šç”³è«‹ã«ã¤ã„ã¦",
	"category": "account_delete",
	"message": "é€€ä¼šæ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„",
	"is_pinned": true
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"id": "uuid",
	"name": "ç”°ä¸­å¤ªéƒ",
	"email": "tanaka@example.com",
	"title": "é€€ä¼šç”³è«‹ã«ã¤ã„ã¦",
	"category": "account_delete",
	"message": "é€€ä¼šæ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„",
	"is_pinned": true,
	"status": "new",
	"is_replied": false,
	"created_at": "2025-07-22T10:30:00Z"
}
```

### ãŠå•ã„åˆã‚ã›è¿”ä¿¡ã‚¹ãƒ¬ãƒƒãƒ‰å–å¾—

**GET** `/rest/v1/contact_reply_threads?contact_id=eq.{contact_id}`

ãŠå•ã„åˆã‚ã›ã®ã‚¹ãƒ¬ãƒƒãƒ‰å½¢å¼ã®è¿”ä¿¡ä¸€è¦§ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
[
	{
		"id": "uuid",
		"contact_id": "uuid",
		"sender_type": "admin",
		"sender_id": "uuid",
		"message": "ã”è³ªå•ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚é€€ä¼šæ–¹æ³•ã¯...",
		"created_at": "2025-07-22T11:00:00Z"
	}
]
```

### å…¨ãŠå•ã„åˆã‚ã›å–å¾—ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

**GET** `/rest/v1/contacts?select=*&order=created_at.desc`

ã™ã¹ã¦ã®ãŠå•ã„åˆã‚ã›ã‚’å–å¾—ã—ã¾ã™ã€‚

### ãŠå•ã„åˆã‚ã›ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

**PATCH** `/rest/v1/contacts?id=eq.{contact_id}`

ãŠå•ã„åˆã‚ã›ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"status": "in_progress",
	"is_replied": true
}
```

---

## FAQ ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆç®¡ç† âœ…

### FAQ ãƒ‡ãƒ¼ã‚¿å–å¾—

**GET** `/rest/v1/faqs?select=*&order=popularity.desc`

äººæ°—åº¦é †ã§ FAQ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
[
	{
		"id": "uuid",
		"question": "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸå ´åˆã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã§ã™ã‹ï¼Ÿ",
		"answer": "ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã®ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸæ–¹ã€ã‹ã‚‰ãƒªã‚»ãƒƒãƒˆã§ãã¾ã™ã€‚",
		"category": "account",
		"popularity": 150,
		"created_at": "2025-07-25T10:30:00Z"
	}
]
```

### äººæ°— FAQ å–å¾—

**GET** `/rest/v1/faqs?select=*&order=popularity.desc&limit=5`

äººæ°—åº¦ä¸Šä½ 5 ä»¶ã® FAQ ã‚’å–å¾—ã—ã¾ã™ã€‚

### FAQ ä½œæˆï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

**POST** `/rest/v1/faqs`

æ–°ã—ã„ FAQ ã‚’ä½œæˆã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"question": "æ–°ã—ã„è³ªå•",
	"answer": "æ–°ã—ã„å›ç­”",
	"category": "basic",
	"popularity": 0
}
```

### FAQ æ›´æ–°ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

**PATCH** `/rest/v1/faqs?id=eq.{faq_id}`

FAQ æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"question": "æ›´æ–°ã•ã‚ŒãŸè³ªå•",
	"answer": "æ›´æ–°ã•ã‚ŒãŸå›ç­”",
	"popularity": 100
}
```

### ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿å­˜

**POST** `/rest/v1/chat_messages`

ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"user_id": "uuid", // åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å ´åˆã¯ null
	"session_id": "session_123456",
	"role": "user", // "user" or "assistant"
	"content": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•å†…å®¹"
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"id": "uuid",
	"user_id": "uuid",
	"session_id": "session_123456",
	"role": "user",
	"content": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•å†…å®¹",
	"created_at": "2025-07-25T10:30:00Z"
}
```

### ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´å–å¾—

**GET** `/rest/v1/chat_messages?session_id=eq.{session_id}&order=created_at.asc`

ç‰¹å®šã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’å–å¾—ã—ã¾ã™ã€‚

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
[
	{
		"id": "uuid",
		"user_id": "uuid",
		"session_id": "session_123456",
		"role": "user",
		"content": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•",
		"created_at": "2025-07-25T10:30:00Z"
	},
	{
		"id": "uuid",
		"user_id": null,
		"session_id": "session_123456",
		"role": "assistant",
		"content": "AI ã®å›ç­”",
		"created_at": "2025-07-25T10:30:05Z"
	}
]
```

---

## OpenAI API çµ±åˆ âœ…

### ãƒãƒ£ãƒƒãƒˆè£œå®Œ

**POST** `/api/chat`

OpenAI API ã¨ RAG (Retrieval-Augmented Generation) ã‚’ä½¿ç”¨ã—ã¦ã€çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ã„ãŸãƒãƒ£ãƒƒãƒˆè£œå®Œã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"message": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•",
	"session_id": "session_123456",
	"user_id": "uuid" // ã‚ªãƒ—ã‚·ãƒ§ãƒ³
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"response": "AI ã®å›ç­”å†…å®¹",
	"session_id": "session_123456",
	"message_id": "uuid"
}
```

### ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­å®š

```typescript
const systemPrompt = {
	role: "system",
	content:
		"ã‚ãªãŸã¯è¦ªåˆ‡ã§çŸ¥è­˜è±Šå¯Œãªã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚æ—¥æœ¬èªã§å›ç­”ã—ã¦ãã ã•ã„ã€‚",
};
```

### ãƒãƒ£ãƒƒãƒˆè¨­å®š

```typescript
const chatConfig = {
	model: "gpt-4o-mini",
	max_tokens: 500,
	temperature: 0.7,
	stream: true,
};
```

---

## æ±ºæ¸ˆçµ±åˆ

### æ±ºæ¸ˆã‚¤ãƒ³ãƒ†ãƒ³ãƒˆä½œæˆ âœ…

**POST** `/api/create-payment-intent`

ãƒ‡ã‚¸ã‚¿ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è³¼å…¥ã®ãŸã‚ã® Stripe æ±ºæ¸ˆã‚¤ãƒ³ãƒ†ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"productId": "uuid",
	"amount": 1
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"clientSecret": "pi_your_payment_intent_secret_here",
	"paymentIntentId": "pi_your_payment_intent_id_here"
}
```

### Stripe Webhook

**POST** `/api/webhooks/stripe`

Stripe webhook ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‡¦ç†ã—ã¾ã™ã€‚

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼

```http
Stripe-Signature: t=1234567890,v1=abc123...
```

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

```json
{
	"type": "payment_intent.succeeded",
	"data": {
		"object": {
			"id": "pi_your_payment_intent_id_here",
			"amount": 1,
			"status": "succeeded"
		}
	}
}
```

---

## ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³

### ãƒ‡ã‚¸ã‚¿ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ›´æ–° âœ…

ãƒ‡ã‚¸ã‚¿ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ›´æ–°ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã€‚

```javascript
const subscription = supabase
	.channel("products")
	.on(
		"postgres_changes",
		{ event: "*", schema: "public", table: "products" },
		(payload) => {
			console.log("å•†å“ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸ:", payload);
		}
	)
	.subscribe();
```

### è³¼å…¥æ›´æ–°

è³¼å…¥æ›´æ–°ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã€‚

```javascript
const subscription = supabase
	.channel("purchases")
	.on(
		"postgres_changes",
		{ event: "*", schema: "public", table: "product_purchases" },
		(payload) => {
			console.log("è³¼å…¥ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸ:", payload);
		}
	)
	.subscribe();
```

### ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ›´æ–° âœ…

ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã€‚

```javascript
const subscription = supabase
	.channel("chat_messages")
	.on(
		"postgres_changes",
		{ event: "*", schema: "public", table: "chat_messages" },
		(payload) => {
			console.log("ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸ:", payload);
		}
	)
	.subscribe();
```

---

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### æ¨™æº–ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
	"error": {
		"code": "ERROR_CODE",
		"message": "äººé–“ãŒèª­ã‚ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
		"details": "è¿½åŠ ã®ã‚¨ãƒ©ãƒ¼è©³ç´°"
	}
}
```

### ä¸€èˆ¬çš„ãªã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰

| ã‚³ãƒ¼ãƒ‰                     | èª¬æ˜                             |
| -------------------------- | -------------------------------- |
| `AUTH_REQUIRED`            | èªè¨¼ãŒå¿…è¦ã§ã™                   |
| `INSUFFICIENT_PERMISSIONS` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¿…è¦ãªæ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ |
| `VALIDATION_ERROR`         | ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ¤œè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ   |
| `NOT_FOUND`                | ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“         |
| `INTERNAL_ERROR`           | å†…éƒ¨ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼               |
| `OPENAI_API_ERROR`         | OpenAI API ã‚¨ãƒ©ãƒ¼                |
| `CHAT_TIMEOUT`             | ãƒãƒ£ãƒƒãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ             |

### ãƒ¬ãƒ¼ãƒˆåˆ¶é™

- **ãƒ¬ãƒ¼ãƒˆåˆ¶é™:** ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ãŸã‚Š 1 åˆ†é–“ã« 100 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- **ãƒ˜ãƒƒãƒ€ãƒ¼:** `X-RateLimit-Limit`, `X-RateLimit-Remaining`, `X-RateLimit-Reset`
- **ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆåˆ¶é™:** 1 åˆ†é–“ã« 10 å›ã®è³ªå•

---

## ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚³ãƒ¼ãƒ‰

| ã‚³ãƒ¼ãƒ‰ | èª¬æ˜                   |
| ------ | ---------------------- |
| 200    | æˆåŠŸ                   |
| 201    | ä½œæˆå®Œäº†               |
| 400    | ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ       |
| 401    | èªè¨¼ãŒå¿…è¦             |
| 403    | ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦           |
| 404    | è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“         |
| 422    | æ¤œè¨¼ã‚¨ãƒ©ãƒ¼             |
| 429    | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¤šã™ãã¾ã™ |
| 500    | å†…éƒ¨ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼     |

---

## SDK ä¾‹

### JavaScript/TypeScript

```typescript
import { createClient } from "@supabase/supabase-js";

const supabase = createClient(
	"https://your-project.supabase.co",
	"your-anon-key"
);

// å•†å“å–å¾—
const { data: products, error } = await supabase
	.from("products")
	.select("*")
	.eq("is_active", true);

// è³¼å…¥ä½œæˆ
const { data: purchase, error } = await supabase
	.from("product_purchases")
	.insert({
		user_id: user.id,
		product_id: productId,
		amount: 1,
		status: "completed",
	});

// FAQ å–å¾—
const { data: faqs, error } = await supabase
	.from("faqs")
	.select("*")
	.order("popularity", { ascending: false })
	.limit(5);

// ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿å­˜
const { data: message, error } = await supabase.from("chat_messages").insert({
	user_id: user?.id || null,
	session_id: sessionId,
	role: "user",
	content: userMessage,
});

// OpenAI API å‘¼ã³å‡ºã—
const response = await fetch("/api/chat", {
	method: "POST",
	headers: {
		"Content-Type": "application/json",
		Authorization: `Bearer ${supabase.auth.session()?.access_token}`,
	},
	body: JSON.stringify({
		message: userMessage,
		session_id: sessionId,
		user_id: user?.id,
	}),
});
const chatResponse = await response.json();
```

### cURL ä¾‹

```bash
# å•†å“å–å¾—
curl -X GET "https://your-project.supabase.co/rest/v1/products?select=*&is_active=eq.true" \
  -H "apikey: your-anon-key" \
  -H "Authorization: Bearer your_jwt_token_here"

# å•†å“ä½œæˆï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
curl -X POST "https://your-project.supabase.co/rest/v1/products" \
  -H "apikey: your-anon-key" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æ–°å•†å“",
    "description": "å•†å“ã®èª¬æ˜",
    "price": 20000,
    "category": "software"
  }'

# FAQ å–å¾—
curl -X GET "https://your-project.supabase.co/rest/v1/faqs?select=*&order=popularity.desc&limit=5" \
  -H "apikey: your-anon-key"

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿å­˜
curl -X POST "https://your-project.supabase.co/rest/v1/chat_messages" \
  -H "apikey: your-anon-key" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "uuid",
    "session_id": "session_123456",
    "role": "user",
    "content": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•"
  }'

# ãƒãƒ£ãƒƒãƒˆè£œå®Œ (OpenAI API)
curl -X POST "https://your-project.supabase.co/api/chat" \
  -H "apikey: your-anon-key" \
  -H "Authorization: "Bearer your_jwt_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "ã“ã‚“ã«ã¡ã¯",
    "session_id": "session_123456"
  }'
```

---

## ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°

API ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã¯ URL ãƒ‘ã‚¹ã§å‡¦ç†ã•ã‚Œã¾ã™ã€‚ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ v1 ã§ã™ã€‚

- **ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** v1
- **éæ¨å¥¨ãƒãƒªã‚·ãƒ¼:** ç ´å£Šçš„å¤‰æ›´ã® 6 ãƒ¶æœˆå‰é€šçŸ¥
- **å¾Œæ–¹äº’æ›æ€§:** 12 ãƒ¶æœˆé–“ç¶­æŒ

- **ã‚µãƒãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«:** api-support@your-domain.com

---

## æŠ€è¡“ã‚µãƒãƒ¼ãƒˆ

- **é–‹ç™ºè€…:** dev@your-domain.com
- **æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:** [æŠ€è¡“æ–‡æ›¸\_JA.md](https://github.com/Yucco-K/showcase-docs/blob/main/%E6%8A%80%E8%A1%93%E6%96%87%E6%9B%B8_JA.md)
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰:** [user-guide_JA.md](https://github.com/Yucco-K/showcase-docs/blob/main/user-guide_JA.md)
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰è©³ç´°:** [ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰è©³ç´°\_JA.md](https://github.com/Yucco-K/showcase-docs/blob/main/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%AC%E3%82%A4%E3%83%89%E8%A9%B3%E7%B4%B0_JA.md)
